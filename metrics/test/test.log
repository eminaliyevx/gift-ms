
          ===============================
          Test run: 1
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 126ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 380 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:23:45
   Duration  1.27s (transform 45ms, setup 0ms, collect 20ms, tests 2ms, environment 0ms, prepare 98ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3393ms)
    ✓ should checkout and place an order (6137ms)


  2 passing (10s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2214ms)
    ✓ should throw an error given invalid credentials (1038ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3046ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-api-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-cart-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-auth-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-business-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-cart-1  Started
6:23:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:23:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.505 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.297 s, estimated 7 s
Ran all test suites.
 Container gift-ms-business-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 52.312745990000664 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 2
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 118ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 384 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:24:36
   Duration  1.39s (transform 59ms, setup 0ms, collect 26ms, tests 2ms, environment 0ms, prepare 97ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3255ms)
    ✓ should checkout and place an order (5716ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2282ms)
    ✓ should throw an error given invalid credentials (1073ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3159ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-auth-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-business-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-auth-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-business-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-auth-1  Started
6:24:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:24:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.454 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.227 s
Ran all test suites.
 Container gift-ms-discount-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 52.051993539996445 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 3
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 127ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 861 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:25:30
   Duration  1.36s (transform 90ms, setup 0ms, collect 23ms, tests 2ms, environment 0ms, prepare 149ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3317ms)
    ✓ should checkout and place an order (6186ms)


  2 passing (10s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2264ms)
    ✓ should throw an error given invalid credentials (1059ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3087ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-api-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-cart-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-api-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-customer-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-category-1  Started
6:25:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:25:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (6.058 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.823 s
Ran all test suites.
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 54.65363594000041 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 4
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 121ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 365 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:26:25
   Duration  1.29s (transform 42ms, setup 0ms, collect 25ms, tests 2ms, environment 0ms, prepare 102ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3417ms)
    ✓ should checkout and place an order (5763ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2166ms)
    ✓ should throw an error given invalid credentials (1037ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3093ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-discount-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-product-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-api-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-api-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-auth-1  Started
6:26:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:26:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts (5.267 s)
PASS apps/business/test/business.controller.spec.ts (5.266 s)
PASS apps/auth/test/auth.service.spec.ts (6.46 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        7.278 s
Ran all test suites.
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 54.63498496999592 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 5
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 127ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 473 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:27:18
   Duration  1.36s (transform 83ms, setup 0ms, collect 24ms, tests 2ms, environment 0ms, prepare 144ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3294ms)
    ✓ should checkout and place an order (5765ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2223ms)
    ✓ should throw an error given invalid credentials (1072ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3060ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-category-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-customer-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-api-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-api-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-auth-1  Started
6:27:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts (5.005 s)
PASS apps/customer/test/customer.controller.spec.ts (5.017 s)
PASS apps/auth/test/auth.service.spec.ts (6.254 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.997 s, estimated 7 s
Ran all test suites.
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 52.523344620995225 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 6
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 121ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 428 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:28:10
   Duration  1.40s (transform 46ms, setup 0ms, collect 22ms, tests 2ms, environment 0ms, prepare 100ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3096ms)
    ✓ should checkout and place an order (5697ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2164ms)
    ✓ should throw an error given invalid credentials (1031ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3090ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-api-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-product-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-attribute-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-api-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-customer-1  Started
6:27:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:27:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.445 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.228 s, estimated 7 s
Ran all test suites.
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.772950403995814 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 7
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 121ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 429 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 1ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:29:01
   Duration  1.38s (transform 128ms, setup 0ms, collect 21ms, tests 1ms, environment 0ms, prepare 228ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3240ms)
    ✓ should checkout and place an order (5839ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2201ms)
    ✓ should throw an error given invalid credentials (1036ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3121ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-api-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-api-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-auth-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-discount-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-business-1  Started
6:28:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:28:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.526 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.297 s
Ran all test suites.
 Container gift-ms-discount-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.433446627996865 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 8
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 119ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 421 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:29:53
   Duration  1.38s (transform 39ms, setup 0ms, collect 20ms, tests 2ms, environment 0ms, prepare 90ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3268ms)
    ✓ should checkout and place an order (5905ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2159ms)
    ✓ should throw an error given invalid credentials (1021ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3068ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-auth-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-category-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-api-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-api-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-customer-1  Started
6:29:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:29:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:29:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:29:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:29:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:29:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:29:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:29:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:29:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:29:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:29:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:29:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:29:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:29:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:29:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:29:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:29:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:29:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:29:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:29:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:29:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:29:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:29:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:29:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:29:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:29:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.427 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.224 s
Ran all test suites.
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 52.164295492000875 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 9
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 114ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 418 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:35:03
   Duration  1.19s (transform 75ms, setup 0ms, collect 20ms, tests 2ms, environment 0ms, prepare 129ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3098ms)
    ✓ should checkout and place an order (5862ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2146ms)
    ✓ should throw an error given invalid credentials (1025ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3031ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Container gift-ms-postgres-1  Running
 Container gift-ms-auth-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-api-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-discount-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-business-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-auth-1  Started
6:34:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:34:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.458 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.245 s
Ran all test suites.
 Container gift-ms-payment-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.63067183800042 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 10
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 120ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 448 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:35:54
   Duration  1.23s (transform 67ms, setup 1ms, collect 20ms, tests 2ms, environment 0ms, prepare 119ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3587ms)
    ✓ should checkout and place an order (6182ms)


  2 passing (10s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2294ms)
    ✓ should throw an error given invalid credentials (1077ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3187ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:16        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-business-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-discount-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-category-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-discount-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-api-1  Started
6:35:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:35:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.66 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.457 s
Ran all test suites.
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 53.114885817997155 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 11
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 118ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 432 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:36:48
   Duration  1.17s (transform 103ms, setup 1ms, collect 27ms, tests 2ms, environment 0ms, prepare 163ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3432ms)
    ✓ should checkout and place an order (5832ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2156ms)
    ✓ should throw an error given invalid credentials (1022ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3120ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-customer-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-auth-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-payment-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-customer-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-product-1  Started
6:36:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:36:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts (5.026 s)
PASS apps/customer/test/customer.controller.spec.ts (5.028 s)
PASS apps/auth/test/auth.service.spec.ts (6.259 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        7.07 s
Ran all test suites.
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 53.12526028300077 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 12
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 116ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 372 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:37:40
   Duration  1.30s (transform 82ms, setup 0ms, collect 21ms, tests 2ms, environment 0ms, prepare 145ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3064ms)
    ✓ should checkout and place an order (5831ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2160ms)
    ✓ should throw an error given invalid credentials (1028ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3030ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-auth-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-auth-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-cart-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-cart-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-attribute-1  Started
6:37:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:37:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.484 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.277 s, estimated 7 s
Ran all test suites.
 Container gift-ms-cart-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.971546690002086 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 13
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 119ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 432 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:38:31
   Duration  1.37s (transform 87ms, setup 0ms, collect 23ms, tests 2ms, environment 0ms, prepare 161ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3312ms)
    ✓ should checkout and place an order (5882ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2132ms)
    ✓ should throw an error given invalid credentials (1021ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3008ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-discount-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-customer-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-product-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-product-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-attribute-1  Started
6:38:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:38:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:38:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:38:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:38:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:38:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:38:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:38:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:38:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:38:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:38:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:38:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:38:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:38:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:38:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:38:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:38:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:38:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:38:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:38:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:38:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:38:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:38:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:38:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:38:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:38:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:38:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:38:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:38:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.265 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.074 s
Ran all test suites.
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.718066561996935 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 14
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 117ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 403 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:39:21
   Duration  1.30s (transform 39ms, setup 0ms, collect 22ms, tests 2ms, environment 0ms, prepare 91ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3230ms)
    ✓ should checkout and place an order (5786ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2156ms)
    ✓ should throw an error given invalid credentials (1040ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3061ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-attribute-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-attribute-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-discount-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-discount-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-api-1  Started
6:39:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.744 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.551 s
Ran all test suites.
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.07745324400067 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 15
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 116ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 457 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:40:12
   Duration  1.38s (transform 45ms, setup 0ms, collect 28ms, tests 2ms, environment 0ms, prepare 96ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3184ms)
    ✓ should checkout and place an order (5762ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2139ms)
    ✓ should throw an error given invalid credentials (1022ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3069ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-api-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-business-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-discount-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-discount-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-attribute-1  Started
6:39:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:39:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.116 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        5.866 s, estimated 6 s
Ran all test suites.
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 49.86672095900029 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 16
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 120ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 393 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 1ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:41:03
   Duration  1.32s (transform 47ms, setup 0ms, collect 18ms, tests 1ms, environment 0ms, prepare 98ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3153ms)
    ✓ should checkout and place an order (5693ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2187ms)
    ✓ should throw an error given invalid credentials (1033ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3005ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-discount-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-product-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-payment-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-customer-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-cart-1  Started
6:40:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:40:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.583 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.383 s
Ran all test suites.
 Container gift-ms-discount-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.21941000699997 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 17
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 123ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 444 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:41:54
   Duration  1.44s (transform 96ms, setup 0ms, collect 22ms, tests 2ms, environment 0ms, prepare 161ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3248ms)
    ✓ should checkout and place an order (5809ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2193ms)
    ✓ should throw an error given invalid credentials (1078ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3035ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-api-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-auth-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-business-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-api-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-attribute-1  Started
6:41:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:41:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:41:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:41:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:41:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:41:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:41:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:41:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:41:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:41:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:41:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:41:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:41:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:41:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:41:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:41:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:41:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:41:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:41:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:41:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:41:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:41:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.673 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.428 s
Ran all test suites.
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.20091949699819 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 18
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 120ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 443 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 1ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:42:45
   Duration  1.23s (transform 45ms, setup 0ms, collect 21ms, tests 1ms, environment 0ms, prepare 104ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3225ms)
    ✓ should checkout and place an order (5737ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2148ms)
    ✓ should throw an error given invalid credentials (1038ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3064ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-customer-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-customer-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-discount-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-discount-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-cart-1  Started
6:42:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:42:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:42:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:42:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:42:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:42:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:42:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:42:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:42:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:42:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:42:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:42:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:42:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:42:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:42:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:42:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:42:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:42:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:42:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:42:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:42:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:42:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:42:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:42:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:42:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:42:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:42:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:42:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:42:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.567 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.347 s
Ran all test suites.
 Container gift-ms-api-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.191280686996876 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 19
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 119ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 472 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:43:36
   Duration  1.32s (transform 42ms, setup 0ms, collect 20ms, tests 2ms, environment 0ms, prepare 94ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3237ms)
    ✓ should checkout and place an order (5823ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2132ms)
    ✓ should throw an error given invalid credentials (1083ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3052ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-product-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-product-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-category-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-product-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-business-1  Started
6:43:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:43:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:43:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:43:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:43:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:43:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:43:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:43:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:43:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:43:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:43:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:43:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:43:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:43:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:43:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:43:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:43:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:43:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:43:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:43:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:43:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:43:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:43:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:43:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:43:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:43:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:43:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:43:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:43:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.388 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.16 s
Ran all test suites.
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.62555824699998 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 20
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 119ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 389 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:44:28
   Duration  1.32s (transform 104ms, setup 0ms, collect 22ms, tests 2ms, environment 0ms, prepare 159ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3190ms)
    ✓ should checkout and place an order (5678ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2240ms)
    ✓ should throw an error given invalid credentials (1058ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3114ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-payment-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-customer-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-customer-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-customer-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-attribute-1  Started
6:44:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:44:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.812 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.622 s
Ran all test suites.
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.25675659800321 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 21
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 117ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 422 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 1ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:45:19
   Duration  1.26s (transform 43ms, setup 0ms, collect 22ms, tests 1ms, environment 0ms, prepare 94ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3215ms)
    ✓ should checkout and place an order (6054ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2233ms)
    ✓ should throw an error given invalid credentials (1127ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3183ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-payment-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-category-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-payment-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-customer-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-business-1  Started
6:45:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.705 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.526 s
Ran all test suites.
 Container gift-ms-api-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.65799076099694 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 22
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 122ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 434 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 1ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:46:11
   Duration  1.35s (transform 81ms, setup 0ms, collect 20ms, tests 1ms, environment 0ms, prepare 140ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3395ms)
    ✓ should checkout and place an order (6000ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2276ms)
    ✓ should throw an error given invalid credentials (1032ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3042ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-discount-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-discount-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-cart-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-business-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-api-1  Started
6:45:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:45:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.447 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.254 s
Ran all test suites.
 Container gift-ms-product-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.31904492599517 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 23
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 119ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 388 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:47:02
   Duration  1.34s (transform 86ms, setup 0ms, collect 21ms, tests 2ms, environment 0ms, prepare 124ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3257ms)
    ✓ should checkout and place an order (5760ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2215ms)
    ✓ should throw an error given invalid credentials (1051ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3098ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-customer-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-attribute-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-product-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-customer-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-auth-1  Started
6:46:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:46:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.365 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.14 s
Ran all test suites.
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.771484443999825 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 24
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 118ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 458 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 1ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:47:54
   Duration  1.32s (transform 42ms, setup 0ms, collect 21ms, tests 1ms, environment 0ms, prepare 97ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3273ms)
    ✓ should checkout and place an order (5930ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2181ms)
    ✓ should throw an error given invalid credentials (1098ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3108ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-api-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-payment-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-api-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-api-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-business-1  Started
6:47:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:47:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:47:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:47:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:47:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:47:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:47:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:47:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:47:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:47:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:47:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:47:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:47:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:47:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:47:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:47:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:47:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:47:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:47:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:47:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:47:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:47:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:47:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:47:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:47:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:47:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:47:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:47:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (6.09 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.854 s
Ran all test suites.
 Container gift-ms-category-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 52.413135274998844 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 25
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 122ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 457 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:48:46
   Duration  1.33s (transform 282ms, setup 0ms, collect 21ms, tests 2ms, environment 0ms, prepare 503ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3304ms)
    ✓ should checkout and place an order (5821ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2277ms)
    ✓ should throw an error given invalid credentials (1115ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3153ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-attribute-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-api-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-api-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-discount-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-business-1  Started
6:48:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:48:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.592 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.391 s, estimated 7 s
Ran all test suites.
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 52.37537535700202 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 26
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 124ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 425 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:49:38
   Duration  1.30s (transform 52ms, setup 0ms, collect 22ms, tests 2ms, environment 0ms, prepare 104ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3486ms)
    ✓ should checkout and place an order (5701ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2236ms)
    ✓ should throw an error given invalid credentials (1069ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3051ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-customer-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-auth-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-api-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-payment-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-discount-1  Started
6:49:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:49:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:49:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:49:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:49:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:49:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:49:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:49:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:49:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:49:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:49:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:49:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:49:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:49:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:49:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:49:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:49:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:49:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:49:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:49:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:49:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:49:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:49:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:49:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:49:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:49:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:49:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:49:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:49:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:49:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.918 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.728 s
Ran all test suites.
 Container gift-ms-cart-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 52.19858446399868 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 27
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 119ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 410 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 1ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:50:30
   Duration  1.20s (transform 45ms, setup 0ms, collect 22ms, tests 1ms, environment 0ms, prepare 88ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3291ms)
    ✓ should checkout and place an order (5930ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2169ms)
    ✓ should throw an error given invalid credentials (1025ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3048ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-business-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-customer-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-product-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-product-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-auth-1  Started
6:50:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:50:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.134 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        5.954 s, estimated 6 s
Ran all test suites.
 Container gift-ms-auth-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.815602168001234 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 28
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 120ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 425 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:51:22
   Duration  1.23s (transform 44ms, setup 1ms, collect 21ms, tests 2ms, environment 0ms, prepare 102ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3244ms)
    ✓ should checkout and place an order (5551ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2185ms)
    ✓ should throw an error given invalid credentials (1082ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3071ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-product-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-api-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-attribute-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-payment-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-api-1  Started
6:51:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.728 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.521 s
Ran all test suites.
 Container gift-ms-category-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 52.04922824599594 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 29
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 118ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 358 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:52:12
   Duration  1.45s (transform 72ms, setup 0ms, collect 20ms, tests 2ms, environment 0ms, prepare 116ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3202ms)
    ✓ should checkout and place an order (5793ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2122ms)
    ✓ should throw an error given invalid credentials (1029ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3031ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-discount-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-category-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-attribute-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-attribute-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-customer-1  Started
6:51:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:51:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.276 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.045 s
Ran all test suites.
 Container gift-ms-business-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.33960893099755 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 30
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 116ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 447 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:53:03
   Duration  1.36s (transform 40ms, setup 0ms, collect 23ms, tests 2ms, environment 0ms, prepare 68ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3250ms)
    ✓ should checkout and place an order (5810ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2213ms)
    ✓ should throw an error given invalid credentials (1035ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3094ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-api-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-category-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-payment-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-business-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-discount-1  Started
6:52:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:52:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.324 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.116 s
Ran all test suites.
 Container gift-ms-api-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.54952200400084 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 31
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 117ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 405 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:53:54
   Duration  1.31s (transform 379ms, setup 0ms, collect 24ms, tests 2ms, environment 0ms, prepare 531ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3183ms)
    ✓ should checkout and place an order (5775ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2169ms)
    ✓ should throw an error given invalid credentials (1069ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3086ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-discount-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-discount-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-discount-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-cart-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-business-1  Started
6:53:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:53:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.514 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.314 s
Ran all test suites.
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.4828158069998 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 32
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 119ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 396 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:54:45
   Duration  1.29s (transform 42ms, setup 0ms, collect 22ms, tests 2ms, environment 0ms, prepare 89ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3188ms)
    ✓ should checkout and place an order (5580ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2142ms)
    ✓ should throw an error given invalid credentials (1044ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3123ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-customer-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-cart-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-api-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-customer-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-payment-1  Started
6:54:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:54:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:54:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:54:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:54:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:54:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:54:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:54:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:54:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:54:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:54:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:54:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:54:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:54:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:54:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:54:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:54:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:54:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:54:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:54:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:54:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:54:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:54:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:54:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:54:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:54:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:54:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.27 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.043 s
Ran all test suites.
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.95053260300308 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 33
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 119ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 452 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:55:37
   Duration  1.20s (transform 56ms, setup 0ms, collect 20ms, tests 2ms, environment 0ms, prepare 111ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3306ms)
    ✓ should checkout and place an order (5660ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2139ms)
    ✓ should throw an error given invalid credentials (1025ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3023ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-api-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-discount-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-payment-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-payment-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-business-1  Started
6:55:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:55:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:55:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:55:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:55:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:55:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:55:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:55:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:55:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:55:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:55:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:55:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:55:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:55:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:55:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:55:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:55:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:55:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:55:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:55:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:55:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:55:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:55:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:55:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:55:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:55:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:55:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:55:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:55:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:55:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.668 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.482 s
Ran all test suites.
 Container gift-ms-customer-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.13975250599533 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 34
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 125ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 408 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:56:28
   Duration  1.37s (transform 172ms, setup 0ms, collect 24ms, tests 2ms, environment 0ms, prepare 279ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3201ms)
    ✓ should checkout and place an order (5722ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2143ms)
    ✓ should throw an error given invalid credentials (1032ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3012ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-category-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-discount-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-auth-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-product-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-auth-1  Started
6:56:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:56:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.518 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.277 s
Ran all test suites.
 Container gift-ms-business-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.023896382004025 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 35
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 120ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 384 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:57:18
   Duration  1.36s (transform 238ms, setup 0ms, collect 22ms, tests 2ms, environment 0ms, prepare 460ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3286ms)
    ✓ should checkout and place an order (5832ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2185ms)
    ✓ should throw an error given invalid credentials (1042ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3043ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-attribute-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-api-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-attribute-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-cart-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-product-1  Started
6:57:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.069 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        5.817 s, estimated 6 s
Ran all test suites.
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.74271374500543 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 36
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 120ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 397 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:58:08
   Duration  1.33s (transform 67ms, setup 0ms, collect 21ms, tests 2ms, environment 0ms, prepare 128ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3272ms)
    ✓ should checkout and place an order (5656ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2148ms)
    ✓ should throw an error given invalid credentials (1032ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3054ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-api-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-category-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-category-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-customer-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-attribute-1  Started
6:57:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:57:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.252 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.005 s
Ran all test suites.
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 49.799938568003476 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 37
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 121ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 391 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  06:59:04
   Duration  1.32s (transform 157ms, setup 0ms, collect 24ms, tests 2ms, environment 0ms, prepare 205ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3112ms)
    ✓ should checkout and place an order (5762ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2144ms)
    ✓ should throw an error given invalid credentials (1020ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3100ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-auth-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-cart-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-payment-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-api-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-category-1  Started
6:58:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:58:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:58:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:58:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:58:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:58:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:58:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:58:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:58:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:58:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:58:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:58:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:58:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:58:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:58:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:58:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:58:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:58:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:58:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:58:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:58:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:58:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:58:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:58:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:58:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:58:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
6:58:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/business/test/business.controller.spec.ts (7.497 s)
PASS apps/customer/test/customer.controller.spec.ts (7.499 s)
PASS apps/category/test/category.controller.spec.ts (7.517 s)
PASS apps/attribute/test/attribute.controller.spec.ts (7.536 s)
PASS apps/cart/test/cart.service.spec.ts (7.608 s)
PASS apps/auth/test/auth.service.spec.ts (9.011 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        9.813 s
Ran all test suites.
 Container gift-ms-auth-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-business-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 56.1371319810003 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 38
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 111ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 466 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:00:18
   Duration  1.38s (transform 85ms, setup 0ms, collect 20ms, tests 2ms, environment 0ms, prepare 141ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3127ms)
    ✓ should checkout and place an order (5921ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2151ms)
    ✓ should throw an error given invalid credentials (1029ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3045ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Container gift-ms-postgres-1  Running
 Container gift-ms-discount-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-product-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-api-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-business-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-product-1  Started
7:00:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.426 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.229 s, estimated 10 s
Ran all test suites.
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 52.484642418004576 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 39
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 117ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 438 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 1ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:01:08
   Duration  1.31s (transform 73ms, setup 0ms, collect 24ms, tests 1ms, environment 0ms, prepare 126ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3304ms)
    ✓ should checkout and place an order (5886ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2177ms)
    ✓ should throw an error given invalid credentials (1090ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3060ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-api-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-discount-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-business-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-discount-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-customer-1  Started
7:00:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:00:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.149 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        5.898 s, estimated 6 s
Ran all test suites.
 Container gift-ms-cart-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.28073724900186 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 40
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 118ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 415 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:01:59
   Duration  1.33s (transform 55ms, setup 0ms, collect 20ms, tests 2ms, environment 0ms, prepare 139ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3081ms)
    ✓ should checkout and place an order (5985ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2188ms)
    ✓ should throw an error given invalid credentials (1037ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3037ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-business-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-discount-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-product-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-customer-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-category-1  Started
7:01:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:01:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.339 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.111 s
Ran all test suites.
 Container gift-ms-auth-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.59653047800064 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 41
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 113ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 436 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:02:50
   Duration  1.34s (transform 83ms, setup 0ms, collect 22ms, tests 2ms, environment 0ms, prepare 142ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3202ms)
    ✓ should checkout and place an order (5816ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2154ms)
    ✓ should throw an error given invalid credentials (1030ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3079ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-payment-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-auth-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-customer-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-category-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-customer-1  Started
7:02:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:02:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.311 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.093 s
Ran all test suites.
 Container gift-ms-api-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.36709215499461 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 42
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 115ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 397 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:03:41
   Duration  1.42s (transform 185ms, setup 0ms, collect 23ms, tests 2ms, environment 0ms, prepare 274ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3312ms)
    ✓ should checkout and place an order (5843ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2145ms)
    ✓ should throw an error given invalid credentials (1041ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3097ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-business-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-customer-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-discount-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-api-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-discount-1  Started
7:03:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:03:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:03:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:03:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:03:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:03:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:03:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:03:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:03:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:03:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:03:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:03:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:03:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:03:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:03:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:03:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:03:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:03:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:03:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:03:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:03:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:03:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:03:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:03:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:03:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:03:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:03:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.343 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.116 s
Ran all test suites.
 Container gift-ms-discount-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.86897447499633 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 43
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 141ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 415 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:04:33
   Duration  1.32s (transform 92ms, setup 0ms, collect 20ms, tests 2ms, environment 0ms, prepare 139ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3273ms)
    ✓ should checkout and place an order (5809ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2155ms)
    ✓ should throw an error given invalid credentials (1035ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3020ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-business-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-business-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-cart-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-api-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-auth-1  Started
7:04:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:04:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:04:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:04:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:04:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:04:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:04:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:04:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:04:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:04:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:04:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:04:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:04:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:04:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:04:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:04:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:04:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:04:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:04:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:04:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:04:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:04:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:04:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:04:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:04:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:04:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:04:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:04:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:04:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.608 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.433 s
Ran all test suites.
 Container gift-ms-customer-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.25677658200264 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 44
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 117ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 451 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:05:23
   Duration  1.32s (transform 44ms, setup 0ms, collect 20ms, tests 2ms, environment 0ms, prepare 82ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3248ms)
    ✓ should checkout and place an order (5895ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2178ms)
    ✓ should throw an error given invalid credentials (1052ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3016ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-payment-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-attribute-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-attribute-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-payment-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-customer-1  Started
7:05:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.405 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.16 s
Ran all test suites.
 Container gift-ms-customer-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.62747463600338 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 45
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 118ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 451 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:06:14
   Duration  1.31s (transform 40ms, setup 0ms, collect 19ms, tests 2ms, environment 0ms, prepare 91ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3185ms)
    ✓ should checkout and place an order (5752ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2204ms)
    ✓ should throw an error given invalid credentials (1041ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (2999ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-payment-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-cart-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-product-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-attribute-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-cart-1  Started
7:05:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:05:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.536 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.314 s
Ran all test suites.
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.22565523999929 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 46
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 118ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 431 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:07:05
   Duration  1.32s (transform 65ms, setup 0ms, collect 19ms, tests 2ms, environment 0ms, prepare 126ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3257ms)
    ✓ should checkout and place an order (5629ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2155ms)
    ✓ should throw an error given invalid credentials (1035ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3030ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-auth-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-payment-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-attribute-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-cart-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-customer-1  Started
7:06:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:06:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.822 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.641 s
Ran all test suites.
 Container gift-ms-customer-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.59308779799938 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 47
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 110ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 390 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:07:57
   Duration  1.28s (transform 52ms, setup 0ms, collect 22ms, tests 2ms, environment 0ms, prepare 101ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3293ms)
    ✓ should checkout and place an order (5604ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2215ms)
    ✓ should throw an error given invalid credentials (1042ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3078ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-payment-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-auth-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-customer-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-discount-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-customer-1  Started
7:07:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:07:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.416 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.239 s
Ran all test suites.
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.56733101199568 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 48
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 124ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 401 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:08:47
   Duration  1.34s (transform 358ms, setup 0ms, collect 22ms, tests 2ms, environment 0ms, prepare 506ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3375ms)
    ✓ should checkout and place an order (5995ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2168ms)
    ✓ should throw an error given invalid credentials (1033ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3070ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-business-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-attribute-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-auth-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-category-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-customer-1  Started
7:08:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:08:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:08:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:08:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:08:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:08:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:08:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:08:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:08:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:08:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:08:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:08:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:08:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:08:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:08:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:08:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:08:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:08:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:08:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:08:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:08:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:08:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:08:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:08:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:08:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:08:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:08:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.395 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.174 s
Ran all test suites.
 Container gift-ms-cart-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.79910776500404 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 49
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 119ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 410 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:09:39
   Duration  1.38s (transform 67ms, setup 0ms, collect 21ms, tests 2ms, environment 0ms, prepare 132ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3279ms)
    ✓ should checkout and place an order (5642ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2149ms)
    ✓ should throw an error given invalid credentials (1041ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3013ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-api-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-api-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-payment-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-discount-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-business-1  Started
7:09:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:09:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.58 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.421 s
Ran all test suites.
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.74852435299754 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 50
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 118ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 485 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 1ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:10:29
   Duration  1.39s (transform 95ms, setup 0ms, collect 20ms, tests 1ms, environment 0ms, prepare 141ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3143ms)
    ✓ should checkout and place an order (5816ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2157ms)
    ✓ should throw an error given invalid credentials (1041ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3082ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-attribute-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-business-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-attribute-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-category-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-business-1  Started
7:10:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:10:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:10:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:10:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:10:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:10:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:10:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:10:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:10:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:10:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:10:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:10:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:10:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:10:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:10:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:10:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:10:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:10:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:10:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:10:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:10:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:10:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:10:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:10:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:10:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:10:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:10:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:10:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:10:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:10:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.204 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        5.964 s, estimated 6 s
Ran all test suites.
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.02722061000019 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 51
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 118ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 421 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 3ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:11:20
   Duration  1.35s (transform 75ms, setup 0ms, collect 27ms, tests 3ms, environment 0ms, prepare 128ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3280ms)
    ✓ should checkout and place an order (5694ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2154ms)
    ✓ should throw an error given invalid credentials (1027ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3062ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-auth-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-product-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-cart-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-cart-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-api-1  Started
7:11:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.577 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.393 s
Ran all test suites.
 Container gift-ms-auth-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.43993964199722 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 52
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 131ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 380 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:12:12
   Duration  1.30s (transform 40ms, setup 0ms, collect 21ms, tests 2ms, environment 0ms, prepare 103ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3203ms)
    ✓ should checkout and place an order (5892ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2185ms)
    ✓ should throw an error given invalid credentials (1066ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3114ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-discount-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-business-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-discount-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-discount-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-product-1  Started
7:11:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:11:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.638 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.406 s
Ran all test suites.
 Container gift-ms-product-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.91558139999956 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 53
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 122ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 440 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:13:03
   Duration  1.28s (transform 65ms, setup 0ms, collect 21ms, tests 2ms, environment 0ms, prepare 113ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3204ms)
    ✓ should checkout and place an order (5788ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2222ms)
    ✓ should throw an error given invalid credentials (1046ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3060ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-cart-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-api-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-category-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-product-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-category-1  Started
7:12:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:12:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.281 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.057 s
Ran all test suites.
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.91703550700098 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 54
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 116ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 418 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:13:54
   Duration  1.42s (transform 114ms, setup 0ms, collect 27ms, tests 2ms, environment 0ms, prepare 184ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3132ms)
    ✓ should checkout and place an order (5761ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2138ms)
    ✓ should throw an error given invalid credentials (1022ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3071ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-api-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-business-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-customer-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-customer-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-attribute-1  Started
7:13:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:13:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.443 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.216 s
Ran all test suites.
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.44133581000567 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 55
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 118ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 410 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:14:45
   Duration  1.34s (transform 83ms, setup 0ms, collect 20ms, tests 2ms, environment 0ms, prepare 133ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3234ms)
    ✓ should checkout and place an order (5737ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2126ms)
    ✓ should throw an error given invalid credentials (1080ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3011ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-discount-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-category-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-auth-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-business-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-attribute-1  Started
7:14:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:14:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.413 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.202 s
Ran all test suites.
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.52160322800279 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 56
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 117ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 399 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 4ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:15:35
   Duration  1.20s (transform 47ms, setup 0ms, collect 25ms, tests 4ms, environment 0ms, prepare 92ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3354ms)
    ✓ should checkout and place an order (5959ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2127ms)
    ✓ should throw an error given invalid credentials (1044ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3052ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-category-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-cart-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-payment-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-discount-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-category-1  Started
7:15:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:15:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.418 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.214 s
Ran all test suites.
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.327292257994415 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 57
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 113ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 512 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:16:32
   Duration  1.29s (transform 130ms, setup 0ms, collect 22ms, tests 2ms, environment 0ms, prepare 208ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3077ms)
    ✓ should checkout and place an order (6170ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2259ms)
    ✓ should throw an error given invalid credentials (1088ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3212ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-category-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-category-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-api-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-attribute-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-auth-1  Started
7:16:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:16:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts (7.644 s)
PASS apps/category/test/category.controller.spec.ts (7.645 s)
PASS apps/cart/test/cart.service.spec.ts (7.686 s)
PASS apps/customer/test/customer.controller.spec.ts (7.792 s)
PASS apps/business/test/business.controller.spec.ts (7.796 s)
PASS apps/auth/test/auth.service.spec.ts (9.045 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        9.834 s
Ran all test suites.
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 58.07897770400346 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 58
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 126ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 421 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:17:56
   Duration  1.32s (transform 42ms, setup 0ms, collect 21ms, tests 2ms, environment 0ms, prepare 98ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3315ms)
    ✓ should checkout and place an order (5892ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2209ms)
    ✓ should throw an error given invalid credentials (1082ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3160ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Container gift-ms-postgres-1  Running
 Container gift-ms-api-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-category-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-auth-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-product-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-auth-1  Started
7:17:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:17:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.367 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.133 s, estimated 10 s
Ran all test suites.
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 53.176754689000546 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 59
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 122ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 412 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:18:48
   Duration  1.41s (transform 117ms, setup 0ms, collect 24ms, tests 2ms, environment 0ms, prepare 213ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3203ms)
    ✓ should checkout and place an order (5871ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2211ms)
    ✓ should throw an error given invalid credentials (1032ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3010ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-category-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-payment-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-auth-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-cart-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-attribute-1  Started
7:18:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:18:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:18:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:18:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:18:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:18:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:18:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:18:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:18:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:18:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:18:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:18:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:18:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:18:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:18:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:18:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:18:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:18:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:18:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:18:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:18:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:18:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:18:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:18:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:18:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:18:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:18:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:18:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:18:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:18:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.655 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.457 s
Ran all test suites.
 Container gift-ms-category-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.5078582379967 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 60
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 117ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 400 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:19:39
   Duration  1.32s (transform 428ms, setup 0ms, collect 22ms, tests 2ms, environment 0ms, prepare 563ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3445ms)
    ✓ should checkout and place an order (6009ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2192ms)
    ✓ should throw an error given invalid credentials (1038ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3016ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-attribute-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-attribute-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-customer-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-attribute-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-cart-1  Started
7:19:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:19:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:19:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:19:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:19:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:19:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:19:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:19:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:19:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:19:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:19:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:19:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:19:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:19:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:19:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:19:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:19:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:19:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:19:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:19:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:19:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:19:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:19:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:19:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:19:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:19:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:19:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:19:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:19:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:19:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.244 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.016 s
Ran all test suites.
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.47716129299998 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 61
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 120ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 446 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 1ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:20:31
   Duration  1.40s (transform 62ms, setup 0ms, collect 24ms, tests 1ms, environment 0ms, prepare 125ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3220ms)
    ✓ should checkout and place an order (5610ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2105ms)
    ✓ should throw an error given invalid credentials (1045ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3053ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-attribute-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-payment-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-customer-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-payment-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-category-1  Started
7:20:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:20:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.552 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.332 s
Ran all test suites.
 Container gift-ms-customer-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.661976420000194 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 62
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 124ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 440 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:21:22
   Duration  1.36s (transform 61ms, setup 0ms, collect 20ms, tests 2ms, environment 0ms, prepare 125ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3349ms)
    ✓ should checkout and place an order (5886ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2241ms)
    ✓ should throw an error given invalid credentials (1047ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3122ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-api-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-customer-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-auth-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-api-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-category-1  Started
7:21:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.547 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.356 s
Ran all test suites.
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 52.24710572100431 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 63
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 121ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 401 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 3ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:22:15
   Duration  1.28s (transform 123ms, setup 0ms, collect 33ms, tests 3ms, environment 0ms, prepare 201ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3263ms)
    ✓ should checkout and place an order (5792ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2183ms)
    ✓ should throw an error given invalid credentials (1037ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3032ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-customer-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-payment-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-auth-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-cart-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-auth-1  Started
7:21:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:21:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (6.06 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.866 s
Ran all test suites.
 Container gift-ms-category-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 52.926994706995785 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 64
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 116ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 451 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:23:07
   Duration  1.41s (transform 43ms, setup 0ms, collect 21ms, tests 2ms, environment 0ms, prepare 98ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3305ms)
    ✓ should checkout and place an order (5947ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2130ms)
    ✓ should throw an error given invalid credentials (1064ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3140ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-category-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-discount-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-business-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-auth-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-customer-1  Started
7:22:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:22:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.387 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.147 s, estimated 7 s
Ran all test suites.
 Container gift-ms-cart-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.44563244699687 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 65
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 123ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 414 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 1ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:23:58
   Duration  1.37s (transform 67ms, setup 0ms, collect 21ms, tests 1ms, environment 0ms, prepare 123ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3223ms)
    ✓ should checkout and place an order (5720ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2202ms)
    ✓ should throw an error given invalid credentials (1025ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3100ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-customer-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-auth-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-discount-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-business-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-customer-1  Started
7:23:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:23:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:23:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:23:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:23:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:23:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:23:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:23:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:23:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:23:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:23:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:23:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:23:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:23:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:23:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:23:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:23:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:23:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:23:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:23:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:23:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:23:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:23:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:23:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:23:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:23:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:23:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:23:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:23:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:23:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.714 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.516 s
Ran all test suites.
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.19622577000409 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 66
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 121ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 450 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:24:49
   Duration  1.41s (transform 508ms, setup 1ms, collect 21ms, tests 2ms, environment 0ms, prepare 731ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3331ms)
    ✓ should checkout and place an order (5899ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2201ms)
    ✓ should throw an error given invalid credentials (1045ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3160ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-api-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-discount-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-discount-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-customer-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-payment-1  Started
7:24:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:24:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.584 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.367 s
Ran all test suites.
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.37066269600391 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 67
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 128ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 448 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:25:41
   Duration  1.35s (transform 44ms, setup 0ms, collect 23ms, tests 2ms, environment 0ms, prepare 112ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3424ms)
    ✓ should checkout and place an order (5758ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2180ms)
    ✓ should throw an error given invalid credentials (1047ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3197ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-category-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-category-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-api-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-api-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-discount-1  Started
7:25:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:25:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:25:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:25:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:25:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:25:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:25:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:25:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:25:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:25:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:25:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:25:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:25:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:25:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:25:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:25:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:25:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:25:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:25:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:25:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:25:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:25:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:25:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:25:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:25:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:25:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:25:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.551 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.316 s
Ran all test suites.
 Container gift-ms-api-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 52.522564840003845 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 68
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 127ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 401 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 1ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:26:33
   Duration  1.42s (transform 43ms, setup 0ms, collect 20ms, tests 1ms, environment 0ms, prepare 98ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3303ms)
    ✓ should checkout and place an order (5823ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2234ms)
    ✓ should throw an error given invalid credentials (1047ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3129ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-api-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-category-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-payment-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-payment-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-product-1  Started
7:26:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:26:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.39 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.179 s
Ran all test suites.
 Container gift-ms-product-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.15857706700265 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 69
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 119ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 416 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:27:25
   Duration  1.23s (transform 41ms, setup 0ms, collect 22ms, tests 2ms, environment 0ms, prepare 99ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3346ms)
    ✓ should checkout and place an order (5814ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2225ms)
    ✓ should throw an error given invalid credentials (1047ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3168ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-product-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-customer-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-business-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-auth-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-product-1  Started
7:27:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:27:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.748 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.55 s
Ran all test suites.
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 52.50580161400139 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 70
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 119ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 356 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:28:16
   Duration  1.33s (transform 86ms, setup 0ms, collect 20ms, tests 2ms, environment 0ms, prepare 143ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3182ms)
    ✓ should checkout and place an order (5851ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2210ms)
    ✓ should throw an error given invalid credentials (1044ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3329ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-cart-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-auth-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-business-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-business-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-api-1  Started
7:28:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.112 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        5.91 s, estimated 6 s
Ran all test suites.
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.76105824299902 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 71
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 120ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 382 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:29:10
   Duration  1.32s (transform 46ms, setup 0ms, collect 20ms, tests 2ms, environment 0ms, prepare 96ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3157ms)
    ✓ should checkout and place an order (5625ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2173ms)
    ✓ should throw an error given invalid credentials (1032ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3006ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-category-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-cart-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-product-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-product-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-discount-1  Started
7:28:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:28:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (6.062 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.853 s
Ran all test suites.
 Container gift-ms-api-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 52.79804856999964 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 72
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 120ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 413 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:30:00
   Duration  1.32s (transform 43ms, setup 0ms, collect 22ms, tests 2ms, environment 0ms, prepare 121ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3242ms)
    ✓ should checkout and place an order (5895ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2176ms)
    ✓ should throw an error given invalid credentials (1053ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3044ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-attribute-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-business-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-customer-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-cart-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-discount-1  Started
7:29:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:29:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.403 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.173 s, estimated 7 s
Ran all test suites.
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.23878597100079 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 73
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 124ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 368 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:30:51
   Duration  1.30s (transform 73ms, setup 0ms, collect 21ms, tests 2ms, environment 0ms, prepare 136ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3172ms)
    ✓ should checkout and place an order (5662ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2222ms)
    ✓ should throw an error given invalid credentials (1038ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3147ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-discount-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-discount-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-discount-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-api-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-business-1  Started
7:30:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:30:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:30:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:30:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:30:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:30:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:30:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:30:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:30:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:30:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:30:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:30:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:30:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:30:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:30:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:30:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:30:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:30:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:30:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:30:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:30:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:30:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:30:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:30:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:30:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:30:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:30:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:30:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.39 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.172 s
Ran all test suites.
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.76640842600167 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 74
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 126ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 398 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:31:42
   Duration  1.41s (transform 467ms, setup 0ms, collect 20ms, tests 2ms, environment 0ms, prepare 642ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3082ms)
    ✓ should checkout and place an order (5909ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2218ms)
    ✓ should throw an error given invalid credentials (1034ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3115ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-auth-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-discount-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-attribute-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-business-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-customer-1  Started
7:31:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:31:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.317 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.12 s
Ran all test suites.
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.48148469699919 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 75
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 113ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 390 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 1ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:32:33
   Duration  1.44s (transform 55ms, setup 0ms, collect 28ms, tests 1ms, environment 0ms, prepare 113ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3217ms)
    ✓ should checkout and place an order (5639ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2306ms)
    ✓ should throw an error given invalid credentials (1073ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3195ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-payment-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-api-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-api-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-business-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-api-1  Started
7:32:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:32:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.462 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.233 s
Ran all test suites.
 Container gift-ms-discount-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.786029923997816 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 76
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 119ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 444 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 1ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:33:25
   Duration  1.39s (transform 38ms, setup 0ms, collect 20ms, tests 1ms, environment 0ms, prepare 80ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3299ms)
    ✓ should checkout and place an order (5838ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2154ms)
    ✓ should throw an error given invalid credentials (1069ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3064ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-cart-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-category-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-discount-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-discount-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-auth-1  Started
7:33:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:33:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:33:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:33:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:33:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:33:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:33:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:33:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:33:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:33:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:33:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:33:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:33:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:33:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:33:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:33:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:33:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:33:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:33:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:33:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:33:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:33:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:33:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:33:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:33:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:33:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:33:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:33:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:33:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:33:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.55 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.354 s
Ran all test suites.
 Container gift-ms-business-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.15220625000447 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 77
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 117ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 444 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:34:16
   Duration  1.25s (transform 46ms, setup 0ms, collect 21ms, tests 2ms, environment 0ms, prepare 100ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3256ms)
    ✓ should checkout and place an order (5638ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2135ms)
    ✓ should throw an error given invalid credentials (1067ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3039ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-product-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-auth-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-auth-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-payment-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-auth-1  Started
7:34:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.529 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.284 s
Ran all test suites.
 Container gift-ms-discount-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.23571321099997 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 78
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 120ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 419 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:35:07
   Duration  1.19s (transform 55ms, setup 0ms, collect 30ms, tests 2ms, environment 0ms, prepare 110ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3157ms)
    ✓ should checkout and place an order (5833ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2228ms)
    ✓ should throw an error given invalid credentials (1028ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3036ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-payment-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-api-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-api-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-attribute-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-customer-1  Started
7:34:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:34:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.349 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.16 s
Ran all test suites.
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.45501697699726 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 79
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 124ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 419 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:35:59
   Duration  1.33s (transform 52ms, setup 0ms, collect 26ms, tests 2ms, environment 0ms, prepare 98ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3271ms)
    ✓ should checkout and place an order (5661ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2192ms)
    ✓ should throw an error given invalid credentials (1028ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3072ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-product-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-auth-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-api-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-api-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-category-1  Started
7:35:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:35:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:35:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:35:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:35:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:35:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:35:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:35:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:35:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:35:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:35:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:35:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:35:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:35:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:35:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:35:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:35:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:35:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:35:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:35:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:35:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:35:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:35:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:35:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:35:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:35:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:35:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:35:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:35:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:35:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.891 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.673 s
Ran all test suites.
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 52.285757389001546 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 80
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 118ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 440 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:36:50
   Duration  1.39s (transform 72ms, setup 0ms, collect 23ms, tests 2ms, environment 0ms, prepare 117ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3231ms)
    ✓ should checkout and place an order (5860ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2187ms)
    ✓ should throw an error given invalid credentials (1032ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3092ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-product-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-payment-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-business-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-product-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-payment-1  Started
7:36:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:36:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.225 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        5.98 s, estimated 6 s
Ran all test suites.
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.27379860199988 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 81
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 116ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 429 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:37:41
   Duration  1.35s (transform 87ms, setup 1ms, collect 20ms, tests 2ms, environment 0ms, prepare 146ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3221ms)
    ✓ should checkout and place an order (5538ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2226ms)
    ✓ should throw an error given invalid credentials (1049ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3045ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-discount-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-api-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-attribute-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-category-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-api-1  Started
7:37:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:37:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.552 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.33 s
Ran all test suites.
 Container gift-ms-product-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.75020237399638 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 82
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 117ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 360 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:38:32
   Duration  1.28s (transform 38ms, setup 0ms, collect 21ms, tests 2ms, environment 0ms, prepare 88ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3320ms)
    ✓ should checkout and place an order (5935ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2151ms)
    ✓ should throw an error given invalid credentials (1099ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3054ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-discount-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-cart-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-cart-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-api-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-business-1  Started
7:38:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:38:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:38:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:38:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:38:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:38:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:38:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:38:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:38:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:38:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:38:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:38:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:38:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:38:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:38:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:38:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:38:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:38:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:38:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:38:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:38:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:38:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:38:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:38:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:38:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:38:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:38:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.564 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.402 s
Ran all test suites.
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.61296454299986 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 83
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 121ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 427 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:39:39
   Duration  1.33s (transform 39ms, setup 0ms, collect 20ms, tests 2ms, environment 0ms, prepare 93ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3355ms)
    ✓ should checkout and place an order (6280ms)


  2 passing (10s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2143ms)
    ✓ should throw an error given invalid credentials (1055ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3232ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:16        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Container gift-ms-postgres-1  Running
 Container gift-ms-payment-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-auth-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-payment-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-category-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-auth-1  Started
7:39:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:39:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts (7.944 s)
PASS apps/category/test/category.controller.spec.ts (7.944 s)
PASS apps/cart/test/cart.service.spec.ts (8.029 s)
PASS apps/business/test/business.controller.spec.ts (8.359 s)
PASS apps/customer/test/customer.controller.spec.ts (8.366 s)
PASS apps/auth/test/auth.service.spec.ts (9.417 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        10.164 s
Ran all test suites.
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 56.34011994100362 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 84
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 114ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 415 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:40:30
   Duration  1.37s (transform 392ms, setup 0ms, collect 24ms, tests 2ms, environment 0ms, prepare 553ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3365ms)
    ✓ should checkout and place an order (5947ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2166ms)
    ✓ should throw an error given invalid credentials (1046ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3098ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-business-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-business-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-discount-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-customer-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-cart-1  Started
7:40:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:40:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        5.636 s, estimated 10 s
Ran all test suites.
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.23453678599745 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 85
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 119ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 422 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:41:21
   Duration  1.36s (transform 89ms, setup 0ms, collect 22ms, tests 2ms, environment 0ms, prepare 126ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3306ms)
    ✓ should checkout and place an order (5863ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2284ms)
    ✓ should throw an error given invalid credentials (1143ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3122ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-api-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-category-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-customer-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-customer-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-auth-1  Started
7:41:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.379 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.206 s
Ran all test suites.
 Container gift-ms-category-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.62897537399829 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 86
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 118ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 411 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:42:12
   Duration  1.38s (transform 50ms, setup 1ms, collect 22ms, tests 2ms, environment 0ms, prepare 107ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3212ms)
    ✓ should checkout and place an order (5788ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2138ms)
    ✓ should throw an error given invalid credentials (1050ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3019ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-auth-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-attribute-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-discount-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-attribute-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-cart-1  Started
7:41:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:41:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.279 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.04 s
Ran all test suites.
 Container gift-ms-discount-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.543654338002206 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 87
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 129ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 406 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:43:05
   Duration  1.32s (transform 85ms, setup 0ms, collect 22ms, tests 2ms, environment 0ms, prepare 138ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3362ms)
    ✓ should checkout and place an order (5811ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2173ms)
    ✓ should throw an error given invalid credentials (1038ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3111ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-payment-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-payment-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-auth-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-payment-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-auth-1  Started
7:42:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:42:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.656 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.462 s
Ran all test suites.
 Container gift-ms-cart-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 52.24380513599515 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 88
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 121ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 384 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:43:56
   Duration  1.30s (transform 58ms, setup 0ms, collect 20ms, tests 2ms, environment 0ms, prepare 121ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3436ms)
    ✓ should checkout and place an order (5786ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2166ms)
    ✓ should throw an error given invalid credentials (1066ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3096ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-discount-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-business-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-payment-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-discount-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-auth-1  Started
7:43:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:43:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:43:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:43:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:43:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:43:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:43:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:43:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:43:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:43:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:43:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:43:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:43:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:43:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:43:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:43:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:43:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:43:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:43:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:43:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:43:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:43:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:43:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:43:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:43:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:43:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:43:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:43:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:43:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:43:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.246 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.021 s
Ran all test suites.
 Container gift-ms-api-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.88919032300264 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 89
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 125ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 431 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:44:49
   Duration  1.19s (transform 165ms, setup 0ms, collect 22ms, tests 2ms, environment 0ms, prepare 389ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3307ms)
    ✓ should checkout and place an order (6061ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2153ms)
    ✓ should throw an error given invalid credentials (1036ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3054ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-customer-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-customer-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-customer-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-api-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-category-1  Started
7:44:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:44:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.737 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.532 s
Ran all test suites.
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 52.35481265699863 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 90
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 123ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 393 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:45:39
   Duration  1.34s (transform 54ms, setup 0ms, collect 26ms, tests 2ms, environment 0ms, prepare 119ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3115ms)
    ✓ should checkout and place an order (5674ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2191ms)
    ✓ should throw an error given invalid credentials (1025ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3048ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-attribute-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-discount-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-attribute-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-attribute-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-auth-1  Started
7:45:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:45:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.341 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.101 s
Ran all test suites.
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.182763654999434 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 91
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 118ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 438 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:46:29
   Duration  1.42s (transform 72ms, setup 0ms, collect 22ms, tests 2ms, environment 0ms, prepare 134ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3268ms)
    ✓ should checkout and place an order (5868ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2225ms)
    ✓ should throw an error given invalid credentials (1029ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3014ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-payment-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-api-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-api-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-attribute-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-cart-1  Started
7:46:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:46:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.161 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        5.946 s, estimated 6 s
Ran all test suites.
 Container gift-ms-customer-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.11034156599641 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 92
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 116ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 414 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:47:19
   Duration  1.35s (transform 58ms, setup 1ms, collect 22ms, tests 2ms, environment 0ms, prepare 118ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3162ms)
    ✓ should checkout and place an order (5830ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2167ms)
    ✓ should throw an error given invalid credentials (1031ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3007ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-payment-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-api-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-api-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-payment-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-auth-1  Started
7:47:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:09 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.356 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.151 s
Ran all test suites.
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.24343752799928 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 93
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 119ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 411 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:48:11
   Duration  1.40s (transform 91ms, setup 0ms, collect 21ms, tests 2ms, environment 0ms, prepare 146ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3204ms)
    ✓ should checkout and place an order (5713ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2138ms)
    ✓ should throw an error given invalid credentials (1023ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3070ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-customer-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-cart-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-api-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-api-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-discount-1  Started
7:47:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:47:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.443 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.229 s
Ran all test suites.
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.56769797500223 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 94
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 114ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 427 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 1ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:49:01
   Duration  1.25s (transform 74ms, setup 1ms, collect 19ms, tests 1ms, environment 0ms, prepare 123ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3203ms)
    ✓ should checkout and place an order (5759ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2164ms)
    ✓ should throw an error given invalid credentials (1027ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (2997ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-cart-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-attribute-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-product-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-business-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-auth-1  Started
7:48:45 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:46 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:47 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:48 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:49 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:50 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:48:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.271 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.028 s
Ran all test suites.
 Container gift-ms-payment-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.585170335002246 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 95
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 115ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 394 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:49:52
   Duration  1.36s (transform 91ms, setup 0ms, collect 24ms, tests 2ms, environment 0ms, prepare 164ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3276ms)
    ✓ should checkout and place an order (5919ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2121ms)
    ✓ should throw an error given invalid credentials (1024ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3020ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-attribute-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-discount-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-customer-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-category-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-payment-1  Started
7:49:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:36 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:37 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:38 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:39 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:40 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:41 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:42 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:43 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:49:44 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.282 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.047 s
Ran all test suites.
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.947344122998416 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 96
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 119ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 430 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:50:43
   Duration  1.45s (transform 375ms, setup 0ms, collect 25ms, tests 2ms, environment 0ms, prepare 540ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3233ms)
    ✓ should checkout and place an order (5671ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2181ms)
    ✓ should throw an error given invalid credentials (1034ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3049ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-category-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-customer-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-attribute-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-discount-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-api-1  Started
7:50:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:27 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:28 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:29 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:30 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:31 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:32 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:33 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:34 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:50:35 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.485 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.256 s
Ran all test suites.
 Container gift-ms-product-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.39931513299793 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 97
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 116ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 431 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 1ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:51:34
   Duration  1.30s (transform 37ms, setup 0ms, collect 21ms, tests 1ms, environment 0ms, prepare 72ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3330ms)
    ✓ should checkout and place an order (5803ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2188ms)
    ✓ should throw an error given invalid credentials (1049ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3117ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-auth-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-discount-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-cart-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-customer-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-auth-1  Started
7:51:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:18 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:19 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:20 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:21 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:22 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:23 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:24 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:25 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:51:26 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.514 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.346 s
Ran all test suites.
 Container gift-ms-discount-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.85182507999986 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 98
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 124ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 435 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:52:25
   Duration  1.31s (transform 63ms, setup 0ms, collect 23ms, tests 2ms, environment 0ms, prepare 132ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3339ms)
    ✓ should checkout and place an order (5755ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     9 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2154ms)
    ✓ should throw an error given invalid credentials (1102ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3176ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:09        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-api-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-cart-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-product-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-cart-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-customer-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-business-1  Started
 Container gift-ms-payment-1  Started
7:52:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:10 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:11 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:12 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:13 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:14 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:15 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:16 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:52:17 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.386 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.176 s
Ran all test suites.
 Container gift-ms-product-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 50.91010795299709 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 99
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 119ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 404 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:53:17
   Duration  1.37s (transform 91ms, setup 0ms, collect 23ms, tests 2ms, environment 0ms, prepare 150ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3099ms)
    ✓ should checkout and place an order (5733ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2195ms)
    ✓ should throw an error given invalid credentials (1031ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3066ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-payment-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-product-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-product-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-business-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-payment-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-business-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-attribute-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-api-1  Started
7:53:00 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:01 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:02 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:03 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:04 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:05 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:06 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:07 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:08 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/category/test/category.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.508 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.289 s
Ran all test suites.
 Container gift-ms-auth-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 51.13698635400087 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        
          ===============================
          Test run: 100
          ===============================
          Standard output
          ===============================
          
> gift-ms@1.0.0 test /home/jarvissa/gift-ms
> pnpm reset:db && docker compose -f docker-compose-test.yml up -d auth customer business category attribute discount product cart payment api && (npm run --prefix ../gift/apps/frontend dev:test &) && pnpm wait && jest && npm run --prefix ../gift/apps/frontend test && docker compose -f docker-compose-test.yml down && pnpm kill:dev-test


> gift-ms@1.0.0 reset:db /home/jarvissa/gift-ms
> docker compose -f docker-compose-test.yml up -d postgres && node -e "setTimeout(() => {}, 1000)" && dotenv -e .env.test -- prisma migrate reset --force

Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "entappmeas", schema "public" at "localhost:5433"

Applying migration `20230417101354_dev_1`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20230417101354_dev_1/
    └─ migration.sql

Running generate... (Use --skip-generate to skip the generators)
[2K[1A[2K[GRunning generate... - Prisma Client
[2K[1A[2K[G✔ Generated Prisma Client (4.13.0 | library) to ./node_modules/.pnpm/@prisma+cli
ent@4.13.0_prisma@4.13.0/node_modules/@prisma/client in 118ms


> frontend@1.0.0 dev:test
> vite --port 5174


> gift-ms@1.0.0 wait /home/jarvissa/gift-ms
> wait-on http://localhost:5001/auth/health http://localhost:5002/customer/health http://localhost:5003/business/health http://localhost:5004/category/health http://localhost:5005/attribute/health http://localhost:5006/discount/health http://localhost:5007/product/health http://localhost:5009/cart/health http://localhost:5174/api/health tcp:0.0.0.0:15001 tcp:0.0.0.0:15011


  VITE v4.2.2  ready in 439 ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose

> frontend@1.0.0 test
> vitest run && cypress run


 RUN  v0.30.1 /home/jarvissa/gift/apps/frontend

 ✓ src/__tests__/utils.test.ts  (1 test) 2ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  07:54:07
   Duration  1.28s (transform 48ms, setup 0ms, collect 20ms, tests 2ms, environment 0ms, prepare 96ms)


================================================================================

  (Run Starting)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Cypress:        12.10.0                                                                        │
  │ Browser:        Electron 106 (headless)                                                        │
  │ Node Version:   v18.16.0 (/home/jarvissa/.nvm/versions/node/v18.16.0/bin/node)                 │
  │ Specs:          3 found (cart.spec.cy.ts, login.spec.cy.ts, register.spec.cy.ts)               │
  │ Searched:       cypress/e2e/**/*.cy.{js,jsx,ts,tsx}                                            │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  cart.spec.cy.ts                                                                 (1 of 3)


  cart
    ✓ should add/drop items to/from cart (3068ms)
    ✓ should checkout and place an order (5614ms)


  2 passing (9s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     8 seconds                                                                        │
  │ Spec Ran:     cart.spec.cy.ts                                                                  │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  login.spec.cy.ts                                                                (2 of 3)


  login
    ✓ should login given valid credentials (2135ms)
    ✓ should throw an error given invalid credentials (1071ms)


  2 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     login.spec.cy.ts                                                                 │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                    
  Running:  register.spec.cy.ts                                                             (3 of 3)


  register
    ✓ should register a business (3063ms)


  1 passing (3s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        1                                                                                │
  │ Passing:      1                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        false                                                                            │
  │ Duration:     3 seconds                                                                        │
  │ Spec Ran:     register.spec.cy.ts                                                              │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘


================================================================================

  (Run Finished)


       Spec                                              Tests  Passing  Failing  Pending  Skipped  
  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ ✔  cart.spec.cy.ts                          00:08        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  login.spec.cy.ts                         00:03        2        2        -        -        - │
  ├────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ ✔  register.spec.cy.ts                      00:03        1        1        -        -        - │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘
    ✔  All specs passed!                        00:15        5        5        -        -        -  


> gift-ms@1.0.0 kill:dev-test /home/jarvissa/gift-ms
> kill $(lsof -t -i :5174)


          ===============================
          Standard error
          ===============================
           Network gift-ms_default  Creating
 Network gift-ms_default  Created
 Container gift-ms-postgres-1  Creating
 Container gift-ms-postgres-1  Created
 Container gift-ms-postgres-1  Starting
 Container gift-ms-postgres-1  Started
 Container gift-ms-product-1  Creating
 Container gift-ms-customer-1  Creating
 Container gift-ms-category-1  Creating
 Container gift-ms-attribute-1  Creating
 Container gift-ms-discount-1  Creating
 Container gift-ms-business-1  Creating
 Container gift-ms-api-1  Creating
 Container gift-ms-payment-1  Creating
 Container gift-ms-auth-1  Creating
 Container gift-ms-cart-1  Creating
 Container gift-ms-product-1  Created
 Container gift-ms-category-1  Created
 Container gift-ms-discount-1  Created
 Container gift-ms-api-1  Created
 Container gift-ms-attribute-1  Created
 Container gift-ms-customer-1  Created
 Container gift-ms-business-1  Created
 Container gift-ms-cart-1  Created
 Container gift-ms-auth-1  Created
 Container gift-ms-payment-1  Created
 Container gift-ms-payment-1  Starting
 Container gift-ms-product-1  Starting
 Container gift-ms-api-1  Starting
 Container gift-ms-cart-1  Starting
 Container gift-ms-customer-1  Starting
 Container gift-ms-attribute-1  Starting
 Container gift-ms-auth-1  Starting
 Container gift-ms-category-1  Starting
 Container gift-ms-business-1  Starting
 Container gift-ms-discount-1  Starting
 Container gift-ms-business-1  Started
 Container gift-ms-cart-1  Started
 Container gift-ms-payment-1  Started
 Container gift-ms-discount-1  Started
 Container gift-ms-api-1  Started
 Container gift-ms-customer-1  Started
 Container gift-ms-product-1  Started
 Container gift-ms-category-1  Started
 Container gift-ms-auth-1  Started
 Container gift-ms-attribute-1  Started
7:53:51 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:52 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:53 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:54 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:55 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:56 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:57 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:58 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
7:53:59 AM [vite] http proxy error at /api/health:
Error: socket hang up
    at connResetException (node:internal/errors:717:14)
    at Socket.socketOnEnd (node:_http_client:526:23)
    at Socket.emit (node:events:525:35)
    at endReadableNT (node:internal/streams/readable:1359:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
PASS apps/category/test/category.controller.spec.ts
PASS apps/attribute/test/attribute.controller.spec.ts
PASS apps/cart/test/cart.service.spec.ts
PASS apps/customer/test/customer.controller.spec.ts
PASS apps/business/test/business.controller.spec.ts
PASS apps/auth/test/auth.service.spec.ts (5.507 s)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.

Test Suites: 6 passed, 6 total
Tests:       4 skipped, 18 passed, 22 total
Snapshots:   0 total
Time:        6.293 s
Ran all test suites.
 Container gift-ms-payment-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-customer-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-cart-1  Stopping
 Container gift-ms-product-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-category-1  Stopping
 Container gift-ms-api-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-auth-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-discount-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-attribute-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-postgres-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-business-1  Stopping
 Container gift-ms-payment-1  Stopping
 Container gift-ms-business-1  Stopped
 Container gift-ms-business-1  Removing
 Container gift-ms-business-1  Removed
 Container gift-ms-discount-1  Stopped
 Container gift-ms-discount-1  Removing
 Container gift-ms-discount-1  Removed
 Container gift-ms-postgres-1  Stopped
 Container gift-ms-postgres-1  Removing
 Container gift-ms-postgres-1  Removed
 Container gift-ms-cart-1  Stopped
 Container gift-ms-cart-1  Removing
 Container gift-ms-cart-1  Removed
 Container gift-ms-api-1  Stopped
 Container gift-ms-api-1  Removing
 Container gift-ms-api-1  Removed
 Container gift-ms-product-1  Stopped
 Container gift-ms-product-1  Removing
 Container gift-ms-product-1  Removed
 Container gift-ms-customer-1  Stopped
 Container gift-ms-customer-1  Removing
 Container gift-ms-customer-1  Removed
 Container gift-ms-attribute-1  Stopped
 Container gift-ms-attribute-1  Removing
 Container gift-ms-attribute-1  Removed
 Container gift-ms-category-1  Stopped
 Container gift-ms-category-1  Removing
 Container gift-ms-category-1  Removed
 Container gift-ms-payment-1  Stopped
 Container gift-ms-payment-1  Removing
 Container gift-ms-payment-1  Removed
 Container gift-ms-auth-1  Stopped
 Container gift-ms-auth-1  Removing
 Container gift-ms-auth-1  Removed
 Network gift-ms_default  Removing
 Network gift-ms_default  Removed

          ===============================
          Completed in 49.60906772499531 seconds
          ===============================
          OS name: Linux
          OS CPU architecture: x64
          CPU model: 12th Gen Intel(R) Core(TM) i7-12700H
          CPU speed: 2688
          ===============================
        